import { HttpEventType, HttpResponse } from '@angular/common/http';
import { Component, Input } from '@angular/core';
import { GlobalConstants } from './../../global-constants';
import * as i0 from "@angular/core";
import * as i1 from "./file-upload.service";
import * as i2 from "@angular/material/form-field";
import * as i3 from "@angular/material/toolbar";
import * as i4 from "@angular/material/button";
import * as i5 from "@angular/common";
import * as i6 from "@angular/material/input";
export class UploadFileComponent {
    constructor(uploadService) {
        this.uploadService = uploadService;
        this.showVisuelImg = false;
        this.withIcon = false;
        this.selectedFileNames = [];
        this.progressInfos = [];
        this.message = [];
        this.previews = [];
        this.imageUrl = GlobalConstants.imgURL;
    }
    ngOnInit() {
        this.imageInfos = this.uploadService.getFiles();
    }
    selectFiles(event) {
        this.message = [];
        this.progressInfos = [];
        this.selectedFileNames = [];
        this.selectedFiles = event.target.files;
        this.previews = [];
        if (this.selectedFiles && this.selectedFiles[0]) {
            const numberOfFiles = this.selectedFiles.length;
            for (let i = 0; i < numberOfFiles; i++) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    console.log(e.target.result);
                    this.previews.push(e.target.result);
                };
                reader.readAsDataURL(this.selectedFiles[i]);
                this.selectedFileNames.push(this.selectedFiles[i].name);
            }
        }
    }
    upload(idx, file) {
        this.progressInfos[idx] = { value: 0, fileName: file.name };
        if (file) {
            this.uploadService.upload(file).subscribe((event) => {
                if (event.type === HttpEventType.UploadProgress) {
                    this.progressInfos[idx].value = Math.round((100 * event.loaded) / event.total);
                }
                else if (event instanceof HttpResponse) {
                    const msg = 'Uploaded the file successfully: ' + file.name;
                    this.message.push(msg);
                    this.imageInfos = this.uploadService.getFiles();
                }
            }, (err) => {
                this.progressInfos[idx].value = 0;
                const msg = 'Could not upload the file: ' + file.name;
                this.message.push(msg);
            });
        }
    }
    uploadFiles() {
        this.message = [];
        if (this.selectedFiles) {
            for (let i = 0; i < this.selectedFiles.length; i++) {
                this.upload(i, this.selectedFiles[i]);
            }
        }
    }
}
UploadFileComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.3.11", ngImport: i0, type: UploadFileComponent, deps: [{ token: i1.FileUploadService }], target: i0.ɵɵFactoryTarget.Component });
UploadFileComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.3.11", type: UploadFileComponent, selector: "igy-upload-file", inputs: { showVisuelImg: "showVisuelImg", withIcon: "withIcon" }, ngImport: i0, template: "<mat-form-field>\r\n  <div class=\"main-upload\" [ngClass]=\"{'main-upload-with-icon': withIcon}\">\r\n    <img src=\"assets/images/icons/close_modal.png\" alt=\"Plus\" *ngIf=\"withIcon\">\r\n    <mat-toolbar class=\"custom-upload\">\r\n      <input matInput [value]=\"selectedFileNames.length ? selectedFileNames : 'Choisir un fichier'\" />\r\n      <button mat-flat-button color=\"primary\" [disabled]=\"!selectedFiles\" (click)=\"uploadFiles()\">\r\n        <img src=\"assets/images/icons/uploadFile.svg\" alt=\"Icons\">\r\n      </button>\r\n    </mat-toolbar>\r\n    <input class=\"initial-upload\" type=\"file\" id=\"fileInput\" name=\"fileInput\" accept=\"image/*\" multiple\r\n           (change)=\"selectFiles($event)\" />\r\n  </div>\r\n</mat-form-field>\r\n<div *ngIf=\"showVisuelImg\" class=\"show-img-preview\">\r\n  <img *ngFor='let preview of previews' [src]=\"preview\" class=\"preview\">\r\n</div>\r\n", styles: ["mat-form-field{width:100%}:host ::ng-deep .main-upload{position:relative}:host ::ng-deep .main-upload .initial-upload{opacity:0;width:100%;height:100%;position:absolute;top:0;z-index:10}:host ::ng-deep .main-upload .custom-upload{background:transparent;flex-direction:row-reverse}:host ::ng-deep .main-upload-with-icon{text-align:center;max-width:200px;margin:auto}:host ::ng-deep .main-upload-with-icon .mat-input-element{text-align:left}:host ::ng-deep .show-img-preview{width:200px;height:200px;overflow:hidden;margin:auto}:host ::ng-deep .show-img-preview>img{width:100%;height:100%;object-fit:contain}:host ::ng-deep .mat-form-field-underline{display:none}:host ::ng-deep .mat-form-field-infix{border-bottom:none;display:flex;justify-content:center}:host ::ng-deep .mat-input-element{font-size:14px;margin-left:10px}:host ::ng-deep .mat-flat-button.mat-primary{background:transparent;padding:0;line-height:0}:host ::ng-deep .mat-toolbar-single-row{height:30px}:host ::ng-deep .mat-form-field-appearance-legacy .mat-form-field-wrapper{padding-bottom:0}\n"], components: [{ type: i2.MatFormField, selector: "mat-form-field", inputs: ["color", "appearance", "hideRequiredMarker", "hintLabel", "floatLabel"], exportAs: ["matFormField"] }, { type: i3.MatToolbar, selector: "mat-toolbar", inputs: ["color"], exportAs: ["matToolbar"] }, { type: i4.MatButton, selector: "button[mat-button], button[mat-raised-button], button[mat-icon-button],             button[mat-fab], button[mat-mini-fab], button[mat-stroked-button],             button[mat-flat-button]", inputs: ["disabled", "disableRipple", "color"], exportAs: ["matButton"] }], directives: [{ type: i5.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { type: i5.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i6.MatInput, selector: "input[matInput], textarea[matInput], select[matNativeControl],      input[matNativeControl], textarea[matNativeControl]", inputs: ["disabled", "id", "placeholder", "name", "required", "type", "errorStateMatcher", "aria-describedby", "value", "readonly"], exportAs: ["matInput"] }, { type: i5.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.3.11", ngImport: i0, type: UploadFileComponent, decorators: [{
            type: Component,
            args: [{ selector: 'igy-upload-file', template: "<mat-form-field>\r\n  <div class=\"main-upload\" [ngClass]=\"{'main-upload-with-icon': withIcon}\">\r\n    <img src=\"assets/images/icons/close_modal.png\" alt=\"Plus\" *ngIf=\"withIcon\">\r\n    <mat-toolbar class=\"custom-upload\">\r\n      <input matInput [value]=\"selectedFileNames.length ? selectedFileNames : 'Choisir un fichier'\" />\r\n      <button mat-flat-button color=\"primary\" [disabled]=\"!selectedFiles\" (click)=\"uploadFiles()\">\r\n        <img src=\"assets/images/icons/uploadFile.svg\" alt=\"Icons\">\r\n      </button>\r\n    </mat-toolbar>\r\n    <input class=\"initial-upload\" type=\"file\" id=\"fileInput\" name=\"fileInput\" accept=\"image/*\" multiple\r\n           (change)=\"selectFiles($event)\" />\r\n  </div>\r\n</mat-form-field>\r\n<div *ngIf=\"showVisuelImg\" class=\"show-img-preview\">\r\n  <img *ngFor='let preview of previews' [src]=\"preview\" class=\"preview\">\r\n</div>\r\n", styles: ["mat-form-field{width:100%}:host ::ng-deep .main-upload{position:relative}:host ::ng-deep .main-upload .initial-upload{opacity:0;width:100%;height:100%;position:absolute;top:0;z-index:10}:host ::ng-deep .main-upload .custom-upload{background:transparent;flex-direction:row-reverse}:host ::ng-deep .main-upload-with-icon{text-align:center;max-width:200px;margin:auto}:host ::ng-deep .main-upload-with-icon .mat-input-element{text-align:left}:host ::ng-deep .show-img-preview{width:200px;height:200px;overflow:hidden;margin:auto}:host ::ng-deep .show-img-preview>img{width:100%;height:100%;object-fit:contain}:host ::ng-deep .mat-form-field-underline{display:none}:host ::ng-deep .mat-form-field-infix{border-bottom:none;display:flex;justify-content:center}:host ::ng-deep .mat-input-element{font-size:14px;margin-left:10px}:host ::ng-deep .mat-flat-button.mat-primary{background:transparent;padding:0;line-height:0}:host ::ng-deep .mat-toolbar-single-row{height:30px}:host ::ng-deep .mat-form-field-appearance-legacy .mat-form-field-wrapper{padding-bottom:0}\n"] }]
        }], ctorParameters: function () { return [{ type: i1.FileUploadService }]; }, propDecorators: { showVisuelImg: [{
                type: Input
            }], withIcon: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXBsb2FkLWZpbGUuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvaWd5LXRlbXBsYXRlcy1tb2R1bGVzL3NyYy9saWIvY29tcG9zYW50cy91cGxvYWQtZmlsZS91cGxvYWQtZmlsZS5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9pZ3ktdGVtcGxhdGVzLW1vZHVsZXMvc3JjL2xpYi9jb21wb3NhbnRzL3VwbG9hZC1maWxlL3VwbG9hZC1maWxlLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxhQUFhLEVBQUUsWUFBWSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDbkUsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQVUsTUFBTSxlQUFlLENBQUM7QUFHekQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLDBCQUEwQixDQUFDOzs7Ozs7OztBQU8zRCxNQUFNLE9BQU8sbUJBQW1CO0lBWTlCLFlBQW9CLGFBQWdDO1FBQWhDLGtCQUFhLEdBQWIsYUFBYSxDQUFtQjtRQVgzQyxrQkFBYSxHQUFZLEtBQUssQ0FBQztRQUMvQixhQUFRLEdBQVksS0FBSyxDQUFDO1FBR25DLHNCQUFpQixHQUFhLEVBQUUsQ0FBQztRQUNqQyxrQkFBYSxHQUFVLEVBQUUsQ0FBQztRQUMxQixZQUFPLEdBQWEsRUFBRSxDQUFDO1FBQ3ZCLGFBQVEsR0FBYSxFQUFFLENBQUM7UUFFeEIsYUFBUSxHQUFHLGVBQWUsQ0FBQyxNQUFNLENBQUM7SUFFcUIsQ0FBQztJQUV4RCxRQUFRO1FBQ04sSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQ2xELENBQUM7SUFFRCxXQUFXLENBQUMsS0FBVTtRQUNwQixJQUFJLENBQUMsT0FBTyxHQUFHLEVBQUUsQ0FBQztRQUNsQixJQUFJLENBQUMsYUFB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QUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQzthQUN2QztTQUNGO0lBQ0gsQ0FBQzs7aUhBM0VVLG1CQUFtQjtxR0FBbkIsbUJBQW1CLHlIQ1hoQyx3NUJBZ0JBOzRGRExhLG1CQUFtQjtrQkFML0IsU0FBUzsrQkFDRSxpQkFBaUI7d0dBS2xCLGFBQWE7c0JBQXJCLEtBQUs7Z0JBQ0csUUFBUTtzQkFBaEIsS0FBSyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEh0dHBFdmVudFR5cGUsIEh0dHBSZXNwb25zZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcbmltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgRmlsZVVwbG9hZFNlcnZpY2UgfSBmcm9tICcuL2ZpbGUtdXBsb2FkLnNlcnZpY2UnO1xuaW1wb3J0IHsgR2xvYmFsQ29uc3RhbnRzIH0gZnJvbSAnLi8uLi8uLi9nbG9iYWwtY29uc3RhbnRzJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnaWd5LXVwbG9hZC1maWxlJyxcbiAgdGVtcGxhdGVVcmw6ICcuL3VwbG9hZC1maWxlLmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vdXBsb2FkLWZpbGUuY29tcG9uZW50LnNjc3MnXSxcbn0pXG5leHBvcnQgY2xhc3MgVXBsb2FkRmlsZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG4gIEBJbnB1dCgpIHNob3dWaXN1ZWxJbWc6IGJvb2xlYW4gPSBmYWxzZTtcbiAgQElucHV0KCkgd2l0aEljb246IGJvb2xlYW4gPSBmYWxzZTtcblxuICBzZWxlY3RlZEZpbGVzPzogRmlsZUxpc3Q7XG4gIHNlbGVjdGVkRmlsZU5hbWVzOiBzdHJpbmdbXSA9IFtdO1xuICBwcm9ncmVzc0luZm9zOiBhbnlbXSA9IFtdO1xuICBtZXNzYWdlOiBzdHJpbmdbXSA9IFtdO1xuICBwcmV2aWV3czogc3RyaW5nW10gPSBbXTtcbiAgaW1hZ2VJbmZvcz86IE9ic2VydmFibGU8YW55PjtcbiAgaW1hZ2VVcmwgPSBHbG9iYWxDb25zdGFudHMuaW1nVVJMO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgdXBsb2FkU2VydmljZTogRmlsZVVwbG9hZFNlcnZpY2UpIHt9XG5cbiAgbmdPbkluaXQoKTogdm9pZCB7XG4gICAgdGhpcy5pbWFnZUluZm9zID0gdGhpcy51cGxvYWRTZXJ2aWNlLmdldEZpbGVzKCk7XG4gIH1cblxuICBzZWxlY3RGaWxlcyhldmVudDogYW55KTogdm9pZCB7XG4gICAgdGhpcy5tZXNzYWdlID0gW107XG4gICAgdGhpcy5wcm9ncmVzc0luZm9zID0gW107XG4gICAgdGhpcy5zZWxlY3RlZEZpbGVOYW1lcyA9IFtdO1xuICAgIHRoaXMuc2VsZWN0ZWRGaWxlcyA9IGV2ZW50LnRhcmdldC5maWxlcztcblxuICAgIHRoaXMucHJldmlld3MgPSBbXTtcbiAgICBpZiAodGhpcy5zZWxlY3RlZEZpbGVzICYmIHRoaXMuc2VsZWN0ZWRGaWxlc1swXSkge1xuICAgICAgY29uc3QgbnVtYmVyT2ZGaWxlcyA9IHRoaXMuc2VsZWN0ZWRGaWxlcy5sZW5ndGg7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bWJlck9mRmlsZXM7IGkrKykge1xuICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuXG4gICAgICAgIHJlYWRlci5vbmxvYWQgPSAoZTogYW55KSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coZS50YXJnZXQucmVzdWx0KTtcbiAgICAgICAgICB0aGlzLnByZXZpZXdzLnB1c2goZS50YXJnZXQucmVzdWx0KTtcbiAgICAgICAgfTtcblxuICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTCh0aGlzLnNlbGVjdGVkRmlsZXNbaV0pO1xuXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRGaWxlTmFtZXMucHVzaCh0aGlzLnNlbGVjdGVkRmlsZXNbaV0ubmFtZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgdXBsb2FkKGlkeDogbnVtYmVyLCBmaWxlOiBGaWxlKTogdm9pZCB7XG4gICAgdGhpcy5wcm9ncmVzc0luZm9zW2lkeF0gPSB7IHZhbHVlOiAwLCBmaWxlTmFtZTogZmlsZS5uYW1lIH07XG5cbiAgICBpZiAoZmlsZSkge1xuICAgICAgdGhpcy51cGxvYWRTZXJ2aWNlLnVwbG9hZChmaWxlKS5zdWJzY3JpYmUoXG4gICAgICAgIChldmVudDogYW55KSA9PiB7XG4gICAgICAgICAgaWYgKGV2ZW50LnR5cGUgPT09IEh0dHBFdmVudFR5cGUuVXBsb2FkUHJvZ3Jlc3MpIHtcbiAgICAgICAgICAgIHRoaXMucHJvZ3Jlc3NJbmZvc1tpZHhdLnZhbHVlID0gTWF0aC5yb3VuZChcbiAgICAgICAgICAgICAgKDEwMCAqIGV2ZW50LmxvYWRlZCkgLyBldmVudC50b3RhbFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50IGluc3RhbmNlb2YgSHR0cFJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zdCBtc2cgPSAnVXBsb2FkZWQgdGhlIGZpbGUgc3VjY2Vzc2Z1bGx5OiAnICsgZmlsZS5uYW1lO1xuICAgICAgICAgICAgdGhpcy5tZXNzYWdlLnB1c2gobXNnKTtcbiAgICAgICAgICAgIHRoaXMuaW1hZ2VJbmZvcyA9IHRoaXMudXBsb2FkU2VydmljZS5nZXRGaWxlcygpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgKGVycjogYW55KSA9PiB7XG4gICAgICAgICAgdGhpcy5wcm9ncmVzc0luZm9zW2lkeF0udmFsdWUgPSAwO1xuICAgICAgICAgIGNvbnN0IG1zZyA9ICdDb3VsZCBub3QgdXBsb2FkIHRoZSBmaWxlOiAnICsgZmlsZS5uYW1lO1xuICAgICAgICAgIHRoaXMubWVzc2FnZS5wdXNoKG1zZyk7XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgdXBsb2FkRmlsZXMoKTogdm9pZCB7XG4gICAgdGhpcy5tZXNzYWdlID0gW107XG5cbiAgICBpZiAodGhpcy5zZWxlY3RlZEZpbGVzKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc2VsZWN0ZWRGaWxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLnVwbG9hZChpLCB0aGlzLnNlbGVjdGVkRmlsZXNbaV0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIiwiPG1hdC1mb3JtLWZpZWxkPlxyXG4gIDxkaXYgY2xhc3M9XCJtYWluLXVwbG9hZFwiIFtuZ0NsYXNzXT1cInsnbWFpbi11cGxvYWQtd2l0aC1pY29uJzogd2l0aEljb259XCI+XHJcbiAgICA8aW1nIHNyYz1cImFzc2V0cy9pbWFnZXMvaWNvbnMvY2xvc2VfbW9kYWwucG5nXCIgYWx0PVwiUGx1c1wiICpuZ0lmPVwid2l0aEljb25cIj5cclxuICAgIDxtYXQtdG9vbGJhciBjbGFzcz1cImN1c3RvbS11cGxvYWRcIj5cclxuICAgICAgPGlucHV0IG1hdElucHV0IFt2YWx1ZV09XCJzZWxlY3RlZEZpbGVOYW1lcy5sZW5ndGggPyBzZWxlY3RlZEZpbGVOYW1lcyA6ICdDaG9pc2lyIHVuIGZpY2hpZXInXCIgLz5cclxuICAgICAgPGJ1dHRvbiBtYXQtZmxhdC1idXR0b24gY29sb3I9XCJwcmltYXJ5XCIgW2Rpc2FibGVkXT1cIiFzZWxlY3RlZEZpbGVzXCIgKGNsaWNrKT1cInVwbG9hZEZpbGVzKClcIj5cclxuICAgICAgICA8aW1nIHNyYz1cImFzc2V0cy9pbWFnZXMvaWNvbnMvdXBsb2FkRmlsZS5zdmdcIiBhbHQ9XCJJY29uc1wiPlxyXG4gICAgICA8L2J1dHRvbj5cclxuICAgIDwvbWF0LXRvb2xiYXI+XHJcbiAgICA8aW5wdXQgY2xhc3M9XCJpbml0aWFsLXVwbG9hZFwiIHR5cGU9XCJmaWxlXCIgaWQ9XCJmaWxlSW5wdXRcIiBuYW1lPVwiZmlsZUlucHV0XCIgYWNjZXB0PVwiaW1hZ2UvKlwiIG11bHRpcGxlXHJcbiAgICAgICAgICAgKGNoYW5nZSk9XCJzZWxlY3RGaWxlcygkZXZlbnQpXCIgLz5cclxuICA8L2Rpdj5cclxuPC9tYXQtZm9ybS1maWVsZD5cclxuPGRpdiAqbmdJZj1cInNob3dWaXN1ZWxJbWdcIiBjbGFzcz1cInNob3ctaW1nLXByZXZpZXdcIj5cclxuICA8aW1nICpuZ0Zvcj0nbGV0IHByZXZpZXcgb2YgcHJldmlld3MnIFtzcmNdPVwicHJldmlld1wiIGNsYXNzPVwicHJldmlld1wiPlxyXG48L2Rpdj5cclxuIl19